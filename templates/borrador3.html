<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>faigothy ‚ú∂ accesorios hechos a mano</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fuente Playfair -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <style>
    /* ---------------------- Tipograf√≠a y color global ---------------------- */
    .font-playfair { font-family: 'Playfair Display', serif; }
    :root{
      --lavanda: #E6E6FA;
      --lavanda-2: #F3E8FF;
      --violeta-1: #CDB4FF;
      --violeta-2: #E9D5FF;
      --negro: #000000;
    }
    /* TODO el texto en negro */
    body, button, a, input, select, p, h1, h2, h3, h4, label, span {
      color: var(--negro) !important;
    }

    /* ---------------------- Animaciones ---------------------- */
    @keyframes logoSlideBounce {
      0% { transform: translateX(-100px) translateY(-50px); opacity: 0; }
      50% { transform: translateX(10px) translateY(10px); opacity: 1; }
      70% { transform: translateX(-5px) translateY(-5px); }
      90% { transform: translateX(0px) translateY(2px); }
      100% { transform: translateX(0) translateY(0); }
    }
    @keyframes textSlideBounce {
      0% { transform: translateX(100px) translateY(-50px); opacity: 0; }
      50% { transform: translateX(-10px) translateY(10px); opacity: 1; }
      70% { transform: translateX(5px) translateY(-5px); }
      90% { transform: translateX(0px) translateY(2px); }
      100% { transform: translateX(0) translateY(0); }
    }
    .logo-animation{ animation: logoSlideBounce 1.6s ease forwards; }
    .text-animation{ animation: textSlideBounce 1.6s ease forwards; }

    /* ---------------------- Navbar ---------------------- */
    #navbar{ background: linear-gradient(90deg,var(--lavanda),white); position:fixed; top:0; left:0; right:0; z-index:50; box-shadow: 0 2px 10px rgba(0,0,0,0.06); }
    .nav-inner{ max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; padding:12px 18px; position:relative; }
    .nav-title{ position:absolute; left:50%; transform:translateX(-50%); font-family:'Playfair Display', serif; font-weight:700; color:var(--negro); pointer-events:none; }

    /* ---------------------- Overlay ---------------------- */
    .overlay{ position:fixed; inset:0; background: rgba(0,0,0,0.24); opacity:0; pointer-events:none; transition: opacity .22s; z-index:45;}
    .overlay.show{ opacity:1; pointer-events:auto; }

    /* ---------------------- Side menu ---------------------- */
    #side-menu{ background: linear-gradient(180deg, var(--lavanda) 0%, #ffffff 100%); transition: transform .28s; transform: translateX(-100%); z-index:60; }
    #side-menu.open { transform: translateX(0); }

    /* ---------------------- Botones (texto NEGRO) ---------------------- */
    .btn-gradient {
      background: linear-gradient(90deg, var(--violeta-1), var(--violeta-2));
      color: var(--negro) !important;
      border-radius: 9999px;
      padding: .5rem 1rem;
      box-shadow: 0 8px 20px rgba(109,40,217,0.06);
      transition: transform .18s, box-shadow .18s, filter .18s;
      border: none;
    }
    .btn-gradient:hover{ transform: translateY(-3px) scale(1.02); box-shadow: 0 14px 36px rgba(76,29,149,0.08); filter:brightness(1.02); }

    /* Bot√≥n a√±adir (claro para que texto negro sea legible) */
    .btn-add {
      background: linear-gradient(90deg, #FFF7FD, var(--lavanda-2));
      color: var(--negro) !important;
      border-radius: 12px;
      padding: .6rem .9rem;
      border: 1px solid rgba(0,0,0,0.06);
      cursor:pointer;
    }
    .btn-add:hover { filter: brightness(0.98); transform: translateY(-2px); }

    /* ---------------------- Cart panel ---------------------- */
    .cart-panel{ position:fixed; top:0; right:0; height:100%; width:380px; max-width:95%; background:#fff; z-index:70; transform:translateX(110%); transition: transform .28s ease; box-shadow:-12px 0 30px rgba(0,0,0,0.06);}
    .cart-panel.open{ transform:translateX(0%); }

    /* Badge carrito: fondo claro, texto negro */
    #cart-count { background: var(--lavanda-2) !important; color: var(--negro) !important; border-radius:9999px; padding:2px 6px; font-size:11px; }

    /* ---------------------- Carousel & cards ---------------------- */
    .carousel-track{ display:flex; gap:18px; overflow-x:auto; scroll-behavior:smooth; padding-bottom:12px; -webkit-overflow-scrolling:touch; }
    .card{ min-width:240px; max-width:320px; flex:0 0 auto; border-radius:14px; overflow:hidden; background:white; transition: transform .22s ease, box-shadow .22s ease; box-shadow:0 8px 24px rgba(16,24,40,0.04); }
    .card:hover{ transform: translateY(-8px) scale(1.02); box-shadow:0 18px 40px rgba(16,24,40,0.08); }

    .carousel-wrap{ position:relative; }
    .arrow-btn { position:absolute; top:50%; transform:translateY(-50%); z-index:30; display:flex; align-items:center; justify-content:center; width:44px; height:44px; border-radius:999px; border:none; cursor:pointer; background: linear-gradient(90deg, rgba(109,40,217,0.95), rgba(76,29,149,0.9)); color:white; box-shadow:0 10px 30px rgba(76,29,149,0.12); opacity:0; transition: opacity .18s ease, transform .12s ease, box-shadow .12s; }
    .carousel-wrap:hover .arrow-btn{ opacity:1; }
    .arrow-left{ left:8px; } .arrow-right{ right:8px; }

    /* ---------------------- Spacing y responsive ---------------------- */
    .section-spacing{ padding-top:56px; padding-bottom:56px; }
    .hidden { display:none !important; }
    @media (max-width:768px){ .card{ min-width:200px; } .nav-title{ font-size:14px; } }

  </style>
</head>
<body class="bg-white">

  <!-- NAVBAR -->
  <nav id="navbar" class="z-50">
    <div class="nav-inner">
      <button id="menu-btn" class="text-gray-700 hover:text-purple-600 focus:outline-none" aria-label="Abrir men√∫">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>

      <div class="nav-title text-xl font-playfair font-bold">FAIGOTHY ‚ú∂ ACCESORIOS HECHOS A MANO</div>

      <div class="flex items-center space-x-4">
        <button id="open-login" class="text-sm px-3 py-1 rounded-full border border-gray-200 hover:bg-gray-50">Iniciar sesi√≥n</button>
        <button id="open-cart" class="relative" aria-label="Abrir carrito">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.6 8h13.2L17 13M7 13h10" />
          </svg>
          <span id="cart-count" class="absolute -top-2 -right-2 text-xs w-auto h-auto rounded-full flex items-center justify-center">0</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- OVERLAY -->
  <div id="overlay" class="overlay" aria-hidden="true"></div>

  <!-- SIDE MENU -->
  <aside id="side-menu" class="fixed top-0 left-0 h-full w-64 z-60 overflow-y-auto">
    <div class="flex items-center justify-between px-5 py-4 border-b border-gray-100">
      <span class="text-lg font-playfair font-bold text-gray-800">Men√∫</span>
      <button id="close-side" class="text-gray-600 hover:text-purple-600" aria-label="Cerrar men√∫">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
      </button>
    </div>

    <nav class="flex flex-col px-6 py-4 space-y-2 text-gray-700 font-medium">
      <a href="#" class="hover:text-purple-600 transition" onclick="showSection('inicio')">Inicio</a>
      <div>
        <button class="w-full text-left flex justify-between items-center hover:text-purple-600 transition font-semibold" onclick="toggleSubmenu('submenu-catalogo')">Cat√°logo
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2 transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
          </svg>
        </button>
        <div id="submenu-catalogo" class="flex flex-col pl-4 mt-2 space-y-1 hidden">
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('accesorios-pelo')">Accesorios para el pelo</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('aros')">Aros</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('anillos')">Anillos</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('cinturones')">Cinturones</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('collares')">Collares</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="showSection('prendas')">Prendas de vestir</a>
          <a href="#" class="hover:text-purple-600 transition" onclick="loadAllProducts()">Todos los productos</a>
        </div>
      </div>
      <a href="#" class="hover:text-purple-600 transition">Nosotros</a>
      <a href="#" class="hover:text-purple-600 transition">Contacto</a>
    </nav>
  </aside>

  <!-- HERO -->
  <header class="w-full h-7 bg-gradient-to-b from-[#E6E6FA] to-white mt-16"></header>
  <section class="flex flex-col items-center mt-[-40px] bg-gradient-to-b from-[#E6E6FA] to-white py-16">
    <div class="flex items-center space-x-6">
      <img src="../img/FAIGOTHY.JPG" alt="Faigothy logo" class="logo-animation w-44 rounded-full shadow-md object-cover" />
      <span class="text-4xl font-playfair font-bold text-center text-black text-animation">
        El susurro de una joya,<br>el eco de tu esencia
      </span>
    </div>
  </section>

  <!-- CATEGOR√çAS -->
  <section class="flex flex-wrap justify-center gap-6 mt-8 px-6">
    <button class="btn-gradient px-5 py-2" onclick="showSection('accesorios-pelo')">ACCESORIOS PARA EL PELO</button>
    <button class="btn-gradient px-5 py-2" onclick="showSection('aros')">AROS</button>
    <button class="btn-gradient px-5 py-2" onclick="showSection('anillos')">ANILLOS</button>
    <button class="btn-gradient px-5 py-2" onclick="showSection('cinturones')">CINTURONES</button>
    <button class="btn-gradient px-5 py-2" onclick="showSection('collares')">COLLARES</button>
    <button class="btn-gradient px-5 py-2" onclick="showSection('prendas')">PRENDAS DE VESTIR</button>
  </section>

  <!-- MAIN -->
  <main class="max-w-7xl mx-auto px-6">

    <!-- INICIO (TODOS LOS PRODUCTOS) - contiene ejemplo EST√ÅTICO + din√°mico -->
    <section id="inicio" class="section-spacing">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Todos los productos</h2>

      <div id="all-carousel" class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg></button>

        <!-- EJEMPLOS EST√ÅTICOS (puedes editar/a√±adir manualmente aqu√≠ sin que JS los borre) -->
        <div id="all-track" class="carousel-track">
          <article class="card">
            <img src="../img/aros1.jpg" alt="Aros Dorados" class="w-full h-52 object-cover">
            <div class="p-4">
              <h3 class="font-playfair font-bold text-lg">Aros Dorados Faigothy (est√°tico)</h3>
              <p class="text-gray-600 text-sm mt-1">Versi√≥n est√°tica de ejemplo</p>
              <p class="mt-2 font-bold text-black text-lg">$12.00</p>
              <button class="btn-add mt-3" data-static="true">A√±adir al carrito</button>
            </div>
          </article>
        </div>

        <button class="arrow-btn arrow-right" aria-label="right"><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg></button>
      </div>
    </section>

    <!-- CADA CATEGOR√çA (vac√≠o: ser√° poblado din√°micamente si no tiene contenido) -->
    <section id="accesorios-pelo" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Accesorios para el pelo</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-accesorios" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

    <section id="aros" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Aros</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-aros" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

    <section id="anillos" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Anillos</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-anillos" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

    <section id="cinturones" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Cinturones</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-cinturones" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

    <section id="collares" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Collares</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-collares" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

    <section id="prendas" class="section-spacing hidden">
      <h2 class="text-3xl font-playfair font-bold mb-6 text-black">Prendas de vestir</h2>
      <div class="carousel-wrap">
        <button class="arrow-btn arrow-left" aria-label="left">‚Äπ</button>
        <div id="track-prendas" class="carousel-track"></div>
        <button class="arrow-btn arrow-right" aria-label="right">‚Ä∫</button>
      </div>
    </section>

  </main>

  <!-- CART PANEL -->
  <aside id="cart-panel" class="cart-panel" aria-hidden="true">
    <div class="p-5 flex items-center justify-between border-b">
      <h3 class="font-playfair font-bold text-lg text-black">Tu carrito</h3>
      <button id="close-cart-panel" class="text-gray-500 hover:text-purple-600">&times;</button>
    </div>
    <div id="cart-list" class="p-5 space-y-3 overflow-y-auto" style="max-height:calc(100% - 160px)"></div>
    <div class="p-5 border-t">
      <div class="flex justify-between items-center mb-3">
        <p class="font-semibold">Subtotal</p>
        <p id="cart-total" class="font-bold">$0.00</p>
      </div>
      <div class="flex gap-2">
        <button id="clear-cart" class="flex-1 py-2 rounded-lg btn-gradient">Vaciar carrito</button>
        <button id="checkout" class="flex-1 py-2 rounded-lg bg-purple-200 text-black hover:bg-purple-300">Finalizar</button>
      </div>
    </div>
  </aside>

  <!-- LOGIN MODAL -->
  <div id="login-modal" class="hidden fixed inset-0 items-center justify-center z-60">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="bg-white rounded-2xl shadow-lg p-6 z-10 w-11/12 max-w-md mx-auto my-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="font-playfair font-bold text-xl">Iniciar sesi√≥n</h3>
        <button id="close-login" class="text-gray-500 hover:text-purple-600">&times;</button>
      </div>
      <label class="block text-sm">Usuario</label>
      <input id="login-user" class="w-full border rounded px-3 py-2 mb-3" placeholder="nombre de usuario" />
      <label class="block text-sm">Contrase√±a (demo)</label>
      <input id="login-pass" type="password" class="w-full border rounded px-3 py-2 mb-3" placeholder="contrase√±a" />
      <label class="block text-sm mb-2">Soy:</label>
      <select id="login-role" class="w-full border rounded px-3 py-2 mb-4">
        <option value="cliente">Cliente</option>
        <option value="admin">Admin</option>
      </select>
      <div class="flex items-center justify-between">
        <button id="login-submit" class="px-4 py-2 rounded-lg btn-gradient">Entrar</button>
        <p id="login-welcome" class="text-sm text-gray-600"></p>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="mt-12">
    <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-4">
      <div class="text-left">
        <p class="font-playfair font-bold text-lg text-black">FAIGOTHY ‚ú∂</p>
        <p class="text-sm text-black">Accesorios hechos a mano</p>
      </div>
      <div class="flex flex-col sm:flex-row items-center gap-3 text-sm">
        <a href="https://instagram.com" target="_blank" class="hover:underline">Instagram: @faigothy</a>
        <a href="mailto:contacto@faigothy.com" class="hover:underline">contacto@faigothy.com</a>
        <a href="tel:+595991234567" class="hover:underline">+595 991 234 567</a>
      </div>
    </div>
    <div class="text-center text-xs text-gray-500 mt-4">¬© 2025 FAIGOTHY. Todos los derechos reservados.</div>
  </footer>

  <!-- JAVASCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Elements
      const overlay = document.getElementById('overlay');
      const sideMenu = document.getElementById('side-menu');
      const menuBtn = document.getElementById('menu-btn');
      const closeSideBtn = document.getElementById('close-side');

      const openLoginBtn = document.getElementById('open-login');
      const loginModal = document.getElementById('login-modal');
      const closeLoginBtn = document.getElementById('close-login');
      const loginSubmitBtn = document.getElementById('login-submit');
      const loginUserInput = document.getElementById('login-user');
      const loginRoleSelect = document.getElementById('login-role');
      const loginWelcome = document.getElementById('login-welcome');

      const openCartBtn = document.getElementById('open-cart');
      const cartPanel = document.getElementById('cart-panel');
      const closeCartPanelBtn = document.getElementById('close-cart-panel');
      const cartListEl = document.getElementById('cart-list');
      const cartCountEl = document.getElementById('cart-count');
      const cartTotalEl = document.getElementById('cart-total');
      const clearCartBtn = document.getElementById('clear-cart');
      const checkoutBtn = document.getElementById('checkout');

      // Safety helper
      function safe(el, name){ if(!el) console.warn('Elemento no encontrado:', name); return el; }
      safe(overlay,'overlay'); safe(sideMenu,'side-menu');

      // Menu handlers
      function openSide(){ sideMenu.style.transform = 'translateX(0)'; overlay.classList.add('show'); }
      function closeSide(){ sideMenu.style.transform = 'translateX(-100%)'; overlay.classList.remove('show'); }
      menuBtn?.addEventListener('click', openSide);
      closeSideBtn?.addEventListener('click', closeSide);

      // Login handlers
      function openLogin(){ loginModal.classList.remove('hidden'); overlay.classList.add('show'); }
      function closeLogin(){ loginModal.classList.add('hidden'); overlay.classList.remove('show'); }
      openLoginBtn?.addEventListener('click', openLogin);
      closeLoginBtn?.addEventListener('click', closeLogin);

      loginSubmitBtn?.addEventListener('click', () => {
        const user = (loginUserInput?.value || 'Usuario').trim();
        const role = loginRoleSelect?.value || 'cliente';
        if(role === 'admin'){ loginWelcome.textContent = `Bienvenida, ${user} (Admin) üëë`; ensureAdminLink(true); }
        else { loginWelcome.textContent = `Hola, ${user} üëã`; ensureAdminLink(false); }
        setTimeout(()=>{ loginWelcome.textContent=''; closeLogin(); }, 900);
      });

      function ensureAdminLink(add){
        const existing = document.getElementById('admin-panel-link');
        if(add && !existing){
          const a = document.createElement('a');
          a.id = 'admin-panel-link';
          a.href = '#';
          a.className = 'hover:text-purple-600 transition';
          a.textContent = 'Panel Admin';
          a.onclick = ()=> alert('Panel Admin (demo)');
          sideMenu.querySelector('nav')?.appendChild(a);
        } else if(!add && existing){ existing.remove(); }
      }

      // Overlay click close
      overlay?.addEventListener('click', () => { closeSide(); closeLogin(); closeCart(); });
      window.addEventListener('keydown', (e) => { if(e.key === 'Escape'){ closeSide(); closeLogin(); closeCart(); }});

      // Products (dynamic source)
      const PRODUCTS = [
        { id:'p1', name:'Diadema Floral Faigothy', price:15, image:'../img/accesorio1.jpg', category:'accesorios-pelo' },
        { id:'p2', name:'Coletero Sat√©n Faigothy', price:8, image:'../img/accesorio2.jpg', category:'accesorios-pelo' },
        { id:'p3', name:'Pinza Perla Faigothy', price:7, image:'../img/accesorio3.jpg', category:'accesorios-pelo' },

        { id:'p4', name:'Aros Dorados Faigothy', price:12, image:'../img/aros1.jpg', category:'aros' },
        { id:'p5', name:'Aros Plata Faigothy', price:11, image:'../img/aros2.jpg', category:'aros' },

        { id:'p6', name:'Anillo Rosa Faigothy', price:14, image:'../img/anillo1.jpg', category:'anillos' },
        { id:'p7', name:'Anillo Ajustable Faigothy', price:16, image:'../img/anillo2.jpg', category:'anillos' },

        { id:'p8', name:'Cintur√≥n Cuero Faigothy', price:20, image:'../img/cinturon1.jpg', category:'cinturones' },

        { id:'p9', name:'Collar Perla Faigothy', price:18, image:'../img/collar1.jpg', category:'collares' },

        { id:'p10', name:'Top Encaje Faigothy', price:22, image:'../img/prenda1.jpg', category:'prendas' }
      ];

      function esc(s){ return String(s).replace(/[&<>"']/g, (m)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

      // Create card DOM node
      function createCard(p){
        const art = document.createElement('article');
        art.className = 'card product-card';
        art.dataset.id = p.id;
        art.innerHTML = `
          <img src="${p.image}" alt="${esc(p.name)}" class="w-full h-52 object-cover">
          <div class="p-4">
            <h3 class="font-playfair font-bold text-lg">${esc(p.name)}</h3>
            <p class="text-gray-600 text-sm mt-1">Producto artesanal</p>
            <p class="mt-2 font-bold text-black text-lg">$${p.price.toFixed(2)}</p>
            <button class="btn-add mt-3">A√±adir al carrito</button>
          </div>
        `;
        return art;
      }

      // Map of tracks
      const mapping = {
        'all-track': null,
        'track-accesorios': 'accesorios-pelo',
        'track-aros': 'aros',
        'track-anillos': 'anillos',
        'track-cinturones': 'cinturones',
        'track-collares': 'collares',
        'track-prendas': 'prendas'
      };

      // Populate carousels: if element empty -> fill; else append dynamic items (keeps static)
      function populateCarousels(){
        Object.keys(mapping).forEach(trackId => {
          const track = document.getElementById(trackId);
          if(!track) return;
          const cat = mapping[trackId];
          const items = cat ? PRODUCTS.filter(x=>x.category===cat) : PRODUCTS;
          // Append items (but avoid duplicates by id)
          items.forEach(it => {
            if(!track.querySelector(`[data-id="${it.id}"]`)) track.appendChild(createCard(it));
          });
        });
        attachAddListeners();
        attachCarouselControls();
      }

      // Carousel controls & drag
      function attachCarouselControls(){
        document.querySelectorAll('.carousel-wrap').forEach(wrap => {
          const track = wrap.querySelector('.carousel-track');
          if(!track) return;
          const left = wrap.querySelector('.arrow-left');
          const right = wrap.querySelector('.arrow-right');
          if(left) left.onclick = ()=> track.scrollBy({ left: - Math.round(track.clientWidth * 0.6), behavior:'smooth' });
          if(right) right.onclick = ()=> track.scrollBy({ left: Math.round(track.clientWidth * 0.6), behavior:'smooth' });

          // drag to scroll
          let isDown=false, startX, scrollLeft;
          track.addEventListener('mousedown', (e)=>{ isDown=true; startX = e.pageX - track.offsetLeft; scrollLeft = track.scrollLeft; track.classList.add('dragging'); });
          window.addEventListener('mouseup', ()=>{ isDown=false; track.classList.remove('dragging'); });
          track.addEventListener('mousemove', (e)=>{ if(!isDown) return; e.preventDefault(); const x = e.pageX - track.offsetLeft; const walk = (x - startX) * 1; track.scrollLeft = scrollLeft - walk; });
        });
      }

      // CART with localStorage
      let CART = JSON.parse(localStorage.getItem('ALAMAE_CART') || '[]');
      function saveCart(){ localStorage.setItem('ALAMAE_CART', JSON.stringify(CART)); }

      // Attach add-to-cart listeners (for static and dynamic)
      function attachAddListeners(){
        // static buttons
        document.querySelectorAll('.btn-add').forEach(btn => {
          btn.onclick = (e) => {
            const card = btn.closest('.card');
            // static example button may not have data-id: try to infer from title or price
            const id = card?.dataset?.id || null;
            let product = null;
            if(id) product = PRODUCTS.find(p=>p.id===id);
            else {
              // fallback: build product from DOM
              const name = card.querySelector('h3')?.textContent.trim() || 'Producto';
              const priceText = card.querySelector('p.mt-2')?.textContent.replace('$','').trim();
              const price = parseFloat(priceText) || 0;
              const img = card.querySelector('img')?.getAttribute('src') || '';
              // generate temporary id
              const genId = 'static-' + Math.random().toString(36).slice(2,9);
              product = { id: genId, name, price, image: img, category: 'misc' };
            }
            addToCart(product);
            btn.animate([{ transform:'scale(1)' },{ transform:'scale(1.06)' }], { duration:140 });
          };
        });
        // dynamic product buttons
        document.querySelectorAll('.product-card .btn-add').forEach(btn => {
          btn.onclick = (e) => {
            const card = btn.closest('.product-card');
            const id = card?.dataset?.id;
            const product = PRODUCTS.find(p=>p.id===id);
            if(product){ addToCart(product); btn.animate([{ transform:'scale(1)' },{ transform:'scale(1.06)' }], { duration:140 }); }
          };
        });
      }

      function addToCart(product){
        if(!product || !product.id) return;
        const existing = CART.find(i=>i.id===product.id);
        if(existing) existing.qty += 1;
        else CART.push({...product, qty:1});
        saveCart();
        updateCartUI();
      }
      function removeFromCart(id){ CART = CART.filter(i=>i.id!==id); saveCart(); updateCartUI(); }
      function changeQty(id, delta){
        const it = CART.find(i=>i.id===id);
        if(!it) return;
        it.qty += delta;
        if(it.qty <= 0) removeFromCart(id);
        saveCart();
        updateCartUI();
      }

      function updateCartUI(){
        const totalQty = CART.reduce((s,p)=>s+p.qty,0);
        cartCountEl.textContent = totalQty;
        if(CART.length === 0){
          cartListEl.innerHTML = "<p class='text-gray-500'>Tu carrito est√° vac√≠o üõçÔ∏è</p>";
          cartTotalEl.textContent = '$0.00';
          return;
        }
        cartListEl.innerHTML = CART.map(p=>`
          <div class="flex items-center gap-3 border-b pb-3">
            <img src="${p.image}" alt="${esc(p.name)}" class="w-12 h-12 rounded object-cover">
            <div class="flex-1">
              <p class="font-semibold">${esc(p.name)}</p>
              <p class="text-sm text-gray-600">x${p.qty} ‚Äî $${(p.price*p.qty).toFixed(2)}</p>
              <div class="mt-2 inline-flex items-center gap-2">
                <button data-action="dec" data-id="${p.id}" class="px-2 py-1 rounded bg-gray-200">-</button>
                <span class="px-2">${p.qty}</span>
                <button data-action="inc" data-id="${p.id}" class="px-2 py-1 rounded bg-gray-200">+</button>
              </div>
            </div>
            <div class="text-right">
              <button data-action="remove" data-id="${p.id}" class="text-red-500 text-sm mt-1 hover:underline">Eliminar</button>
            </div>
          </div>
        `).join('');
        cartListEl.querySelectorAll('button[data-action]').forEach(b=>{
          b.onclick = (ev)=>{ ev.stopPropagation(); const id=b.dataset.id; const a=b.dataset.action; if(a==='inc') changeQty(id,1); if(a==='dec') changeQty(id,-1); if(a==='remove') removeFromCart(id); };
        });
        const total = CART.reduce((s,p)=>s + p.price*p.qty, 0);
        cartTotalEl.textContent = `$${total.toFixed(2)}`;
      }

      // Cart open/close
      function openCart(){ cartPanel.classList.add('open'); overlay.classList.add('show'); updateCartUI(); }
      function closeCart(){ cartPanel.classList.remove('open'); overlay.classList.remove('show'); }
      openCartBtn?.addEventListener('click', openCart);
      closeCartPanelBtn?.addEventListener('click', closeCart);
      clearCartBtn?.addEventListener('click', ()=>{ CART=[]; saveCart(); updateCartUI(); });

      checkoutBtn?.addEventListener('click', ()=>{
        if(CART.length===0){ alert('Tu carrito est√° vac√≠o üòä'); return; }
        alert(`Gracias por tu compra. Total: ${cartTotalEl.textContent}`);
        CART=[]; saveCart(); updateCartUI(); closeCart();
      });

      // Sections and helpers
      function showSection(id){
        document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
        const el = document.getElementById(id);
        if(el) el.classList.remove('hidden');
        closeSide();
        document.querySelectorAll('.carousel-track').forEach(t=>t.scrollLeft = 0);
      }
      function loadAllProducts(){ showSection('inicio'); }
      function toggleSubmenu(id){ const el=document.getElementById(id); if(el) el.classList.toggle('hidden'); }

      // Init
      populateCarousels();
      attachAddListeners();
      attachCarouselControls();
      showSection('inicio');
      updateCartUI();

      // Close on overlay click
      overlay.addEventListener('click', ()=>{ closeSide(); closeLogin(); closeCart(); });

      // Expose functions (useful)
      window.showSection = showSection;
      window.toggleSubmenu = toggleSubmenu;
      window.loadAllProducts = loadAllProducts;
    });
  </script>
</body>
</html>
